<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TRON Wallet</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  body { font-family: system-ui, sans-serif; background: #0d1117; color: #fff; margin: 0; padding: 20px; }
  .card { background: #161b22; padding: 20px; border-radius: 12px; }
  button { background: #0088cc; color: #fff; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; }
</style>
</head>
<body>
  <h2>üíº –í–∞—à TRON –∫–æ—à–µ–ª—ë–∫</h2>
  <div class="card" id="wallet">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
  <br>
  <button id="refresh">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

const API_URL = "https://onrender.com/api";

const user = tg.initDataUnsafe?.user;
if (!user) {
  document.getElementById("wallet").innerText = "–û—à–∏–±–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω.";
} else {
  loadWallet(user.id);
}

function loadWallet(userId) {
  fetch(`${API_URL}/wallet/${userId}`)
    .then(r => r.json())
    .then(data => {
      if (data.error) {
        document.getElementById("wallet").innerHTML = "–ö–æ—à–µ–ª—ë–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω.";
      } else {
        document.getElementById("wallet").innerHTML = `
          <b>–ê–¥—Ä–µ—Å:</b> ${data.address}<br>
          üí∞ TRX: ${data.trx_balance}<br>
          üíµ USDT: ${data.usdt_balance}<br>
          ‚ö° Energy: ${data.energy}<br>
          <a href="https://tronscan.org/#/address/${data.address}" target="_blank" style="color:#00bfff">Tronscan</a>
        `;
      }
    });
}

document.getElementById("refresh").addEventListener("click", () => {
  loadWallet(user.id);
});
</script>
</body>
</html>
