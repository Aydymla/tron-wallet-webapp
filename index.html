<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TRON Wallet</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  body { font-family: system-ui, sans-serif; background: #0d1117; color: #fff; margin: 0; padding: 20px; }
  .card { background: #161b22; padding: 20px; border-radius: 12px; }
  button { background: #0088cc; color: #fff; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; margin-right: 10px; }
</style>
</head>
<body>
  <h2>💼 Ваш TRON кошелёк</h2>
  <div class="card" id="wallet">Загрузка...</div>
  <br>
  <button id="refresh">🔄 Обновить</button>
  <button id="send">📤 Отправить данные боту</button>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

const user = tg.initDataUnsafe?.user;
const walletDiv = document.getElementById("wallet");

if (!user) {
  walletDiv.innerText = "Ошибка: пользователь не найден.";
} else {
  walletDiv.innerHTML = `
    👤 Пользователь: <b>${user.first_name}</b><br>
    🆔 ID: <code>${user.id}</code><br>
    ✅ WebApp подключен!
  `;
}

// Кнопка "Обновить"
document.getElementById("refresh").addEventListener("click", () => {
  tg.HapticFeedback.impactOccurred("medium"); // лёгкая вибрация
  tg.showAlert("🔄 Обновление данных... (обновление пока тестовое)");
});

// Кнопка "Отправить данные боту"
document.getElementById("send").addEventListener("click", () => {
  tg.HapticFeedback.notificationOccurred("success");
  tg.sendData(JSON.stringify({
    action: "get_balance",
    user_id: user.id
  }));
  tg.showPopup({
    title: "Отправлено ✅",
    message: "Данные отправлены боту.\nПроверь Telegram.",
    buttons: [{id: "ok", type: "close", text: "ОК"}]
  });
});
</script>
</body>
</html>
